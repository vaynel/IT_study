
# Ubuntu 24.04 SSH 사용자 추가 및 키 인증 설정 가이드

이 가이드는 `root` 계정에서 새로운 사용자를 생성하고, Windows 환경에서 SSH 키로 접속하기 위한 설정을 다룹니다.

## 1. 서버 측 작업 (Root 계정)

### Step 1: 새 사용자 생성

`example_user` 자리에 원하는 계정명을 입력하세요.

```bash
# 사용자 생성 및 홈 디렉토리 자동 생성
adduser example_user

```

* 실행 후 비밀번호와 사용자 정보를 입력하라는 메시지가 나옵니다. 비밀번호만 설정하고 나머지는 `Enter`로 넘기셔도 무방합니다.

### Step 2: Sudo 권한 부여 (선택 사항)

새 계정에 관리자 권한이 필요하다면 수행합니다.

```bash
usermod -aG sudo example_user

```

---

## 2. 클라이언트 측 작업 (Windows)

Windows의 **PowerShell** 또는 **CMD**를 열고 실행합니다.

### Step 1: SSH 키 쌍 생성

이미 키가 있다면 생략해도 됩니다.

```powershell
ssh-keygen -t ed25519 -f $env:USERPROFILE\.ssh\id_ed25519_server

```

* `-t ed25519`: 보안성과 성능이 좋은 최신 알고리즘입니다.
* 생성 중 물어보는 `passphrase`는 키 자체의 비밀번호입니다. (엔터 시 비밀번호 없음)

### Step 2: 공개키(Public Key) 내용 확인

생성된 파일 중 `.pub` 확장자 파일의 내용을 복사합니다.

```powershell
cat $env:USERPROFILE\.ssh\id_ed25519_server.pub

```

* 출력되는 `ssh-ed25519 AAAA...` 형태의 문자열 전체를 복사해 두세요.

---

## 3. 서버 측 작업 (다시 Root 또는 새 유저)

새 사용자의 홈 디렉토리에 공개키를 등록합니다.

### Step 1: SSH 디렉토리 생성 및 권한 설정

```bash
# 새 사용자로 전환
su - example_user

# SSH 설정 디렉토리 생성
mkdir -p ~/.ssh
chmod 700 ~/.ssh

# authorized_keys 파일 생성 및 복사한 공개키 붙여넣기
echo "복사한_공개키_내용_여기에_붙여넣기" > ~/.ssh/authorized_keys

# 권한 설정 (매우 중요: 권한이 다르면 SSH 접속 거부됨)
chmod 600 ~/.ssh/authorized_keys

```

---

## 4. SSH 설정 확인 및 재시작 (Root 계정)

비밀번호 접속을 막고 키 인증만 허용하려면 `/etc/ssh/sshd_config`를 수정해야 하지만, 우선 접속 여부부터 확인하는 것이 안전합니다.

```bash
# SSH 서비스 상태 확인 (필요시 재시작)
systemctl restart ssh

```

---

## 5. Windows에서 접속하기

이제 Windows 터미널에서 아래 명령어로 접속합니다.

```powershell
ssh -i ~\.ssh\id_ed25519_server example_user@서버_IP_주소

```

### 매번 키 경로 입력하기 귀찮다면?

Windows의 `~/.ssh/config` 파일을 메모장으로 열어 아래 내용을 추가하세요.

```text
Host my-server
    HostName 서버_IP_주소
    User example_user
    IdentityFile ~/.ssh/id_ed25519_server

```

설정 후에는 `ssh my-server` 만 입력해도 바로 접속됩니다.

---


