# 루틴 자동화 및 관리

## 개요

하루의 루틴을 Notion DB에서 정의하고,
n8n이 이를 읽어 Slack으로 알림을 전송하며,
Slack에서 완료 버튼 클릭 시 Notion에 상태를 기록한다.
매일 22시에 자동 점검 알림을 통해 수행 여부를 관리한다.

---

## 사용 기술 및 어플리케이션

* **Notion (DB)** – 루틴 및 학습 데이터 저장소
* **n8n** – 자동화 백엔드
* **Slack** – 알림 및 사용자 인터페이스
* **Webhook** – Slack 버튼 → n8n 연결
* **MCP (선택)** – AI 기반 콘텐츠 생성 확장용

---

# 설계

## 1. 시스템 구조

### ① Notion (Database Layer)

#### DB 1: 루틴 관리 (Routines)

| 필드명              | 타입             | 설명                     |
| ---------------- | -------------- | ---------------------- |
| name             | title          | 루틴 이름 (Toeic, QT 등)    |
| enabled          | checkbox       | 활성화 여부                 |
| notify_time      | select / multi | 알림 시간 (morning, night) |
| difficulty_level | number         | 학습 단계 관리               |
| description      | text           | 루틴 설명                  |

---

#### DB 2: Daily Log (일일 수행 기록)

| 필드명     | 타입       | 설명             |
| ------- | -------- | -------------- |
| date    | date     | 수행 날짜          |
| routine | relation | Routines DB 연결 |
| status  | select   | pending / done |
| note    | text     | 메모             |
| score   | number   | 학습 점수 (선택)     |

---

### ② n8n (Backend Automation)

#### 역할 1: 아침 루틴 생성

* Notion Routines DB 조회 (enabled = true)
* AI로 오늘 학습 내용 생성 (난이도 기반)
* Daily Log에 오늘 row 생성 (status = pending)
* Slack으로 브리핑 전송

---

#### 역할 2: Slack 완료 버튼 처리

* Slack 버튼 클릭 → Webhook
* Webhook → Notion Daily Log status = done 업데이트
* Slack에 완료 확인 메시지 전송

---

#### 역할 3: 22시 점검 자동화

* Notion Daily Log 조회 (오늘 날짜, status = pending)
* 미완료 루틴 목록 생성
* Slack에 리마인드 전송
* 전부 완료 시 완료 축하 메시지

---

### ③ Slack (Frontend)

* 아침 브리핑
* 학습 완료 버튼
* 22시 리마인드
* 완료 시 피드백 메시지

---

# 주요 기능

## 기능 1: 루틴 자동 생성

* Notion DB 기반으로 루틴 자동 생성
* AI를 사용하여 난이도에 맞는 학습 콘텐츠 자동 제작
* Slack으로 전달

---

## 기능 2: Slack 버튼 기반 완료 처리

* Slack Block Kit 버튼 제공
* 클릭 시 n8n Webhook 호출
* Notion 상태 업데이트

---

## 기능 3: 22시 자동 점검 및 통계 관리

* 미완료 루틴 자동 탐지
* 남은 루틴만 리마인드
* 주간 완료율 집계 가능
* 월간 리포트 확장 가능

---

## 기능 4 (확장): 학습 레벨 자동 상승

* 최근 7일 완료율 계산
* 완료율 ≥ 80% → difficulty_level 자동 증가
* 학습 강도 자동 조절

---

## 기능 5 (확장): 주간 리포트

* 매주 일요일 밤 자동 생성
* 수행률 %
* 루틴별 완료 횟수
* Slack 요약 보고서 전송

---

# n8n 워크플로우 구성

## Workflow A – 아침 브리핑 (07:30)

Cron → Notion Read (Routines) → AI 생성 → Notion Create (Daily Log) → Slack Send

---

## Workflow B – 완료 처리 (Webhook)

Slack Button → Webhook → Notion Update → Slack Confirm

---

## Workflow C – 22시 점검

Cron → Notion Query (today, pending) → IF → Slack Reminder

---

# 일정

| 단계  | 기간                      | 비고                 |
| --- | ----------------------- | ------------------ |
| 계획  | 2026-02-12 ~ 2026-02-13 | DB 설계              |
| 설계  | 2026-02-14              | Slack Block Kit 설계 |
| 구현  | 2026-02-15 ~ 2026-02-17 | n8n 워크플로우 구축       |
| 테스트 | 2026-02-18 ~ 2026-02-20 | 실제 루틴 1주 운영        |
| 개선  | 2026-02-21              | 통계 및 레벨 시스템 추가     |

---

# 보안 설계

* Webhook URL에 토큰 파라미터 사용
* Slack App Signing Secret 검증
* Notion API Key는 n8n Credential로 관리
* 공개 접근 차단

---

# 향후 확장 방향

* AI 기반 토익 오답 분석 자동화
* 뉴스 요약 품질 향상 (검색 API 연동)
* QT 본문 자동 추천
* 월간 리포트 PDF 자동 생성
* 모바일 전용 체크 페이지 구축

---

# 참고 자료

* Notion API 공식 문서
* Slack Block Kit Builder
* n8n 공식 문서
* OpenAI / MCP 연동 가이드