# 🚀 새 프로젝트 자동 배포 연결 가이드

## 1단계: 보안 토큰(Secret) 생성

각 프로젝트별로 독립적인 보안을 유지하기 위해 새 토큰을 생성합니다.

```bash
# 터미널에서 실행하여 생성된 문자열을 복사해두세요.
openssl rand -base64 32

```

## 2단계: 서버에 레포지토리 클론 (Initial Setup)

블로그 콘텐츠 폴더로 이동하여 새 레포지토리를 클론합니다.

```bash
cd /root/blog/content
git clone https://github.com/사용자명/새레포지토리명.git 새폴더명

```

## 3단계: `webhook_server.py` 설정 업데이트

새 프로젝트 정보를 `PROJECTS` 딕셔너리에 추가합니다.

```python
# vi /root/blog/webhook_server.py
PROJECTS = {
    "IT_study": { ... 기존 설정 ... },
    
    "새레포지토리명": {  # GitHub 레포지토리 이름과 일치해야 함
        "path": "/root/blog/content/새폴더명",
        "secret": b"1단계에서_생성한_토큰",
        "build_cmd": "npx quartz build"
    }
}

```

## 4단계: Webhook 서버 재시작 (Restart)

수정한 파이썬 코드를 실제 서비스에 반영합니다. `reload`보다는 프로세스를 완전히 새로 시작하는 `restart`가 안전합니다.

```bash
# 서비스 재시작
systemctl restart quartz-webhook.service

# 서비스가 정상적으로 살아있는지 확인
systemctl status quartz-webhook.service

```

## 5단계: GitHub Webhook 연결 및 테스트

1. **GitHub 접속**: 새 레포지토리 > **Settings** > **Webhooks** > **Add webhook**.
2. **Payload URL**: `https://blog.log2u.me/webhook`
3. **Content type**: `application/json`
4. **Secret**: 1단계에서 생성한 토큰 문자열 입력.
5. **Event**: `Just the push event` 선택 후 저장.
6. **테스트**: 생성된 웹훅의 **Recent Deliveries**에서 **Ping** 테스트 결과가 `200 OK`인지 확인합니다.

## 6단계: 최종 적용 및 모니터링

실제로 새 레포지토리에 커밋을 Push한 후, 서버에서 빌드가 돌아가는지 로그를 감시합니다.

```bash
# 실시간 빌드 로그 모니터링
journalctl -u quartz-webhook.service -f

```